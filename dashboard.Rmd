---
title: "CO2 Emission Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    theme: spacelab
vertical_layout: scroll
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(dplyr)
library(ggplot2)
library(miniUI)
library(DT)
#library(tidyverse)
countries_by_fuel = read.csv("E:\\co2-emissions-by-fuel-line.csv", header=TRUE)
countries_annual_co2_emission = read.csv("E:\\annual-co2-emissions-per-country.csv", header=TRUE)
countries_year_wise_co2_change = read.csv("E:\\absolute-change-co2.csv", header=TRUE)
total_ghg_emissions = read.csv("E:\\total-ghg-emissions.csv", header=TRUE)
percapita_ghg_emissions = read.csv("E:\\per-capita-ghg-emissions.csv", header=TRUE)
methane_emissions = read.csv("E:\\methane-emissions.csv", header=TRUE)
nitrous_oxide_emissions = read.csv("E:\\nitrous-oxide-emissions.csv", header=TRUE)
global_co2_concentration = read.csv("E:\\global-co-concentration-ppm.csv", header=TRUE)
global_methane_concentration = read.csv("E:\\ch4-concentration.csv", header=TRUE)
global_nitrous_oxide_concentration = read.csv("E:\\n2o-concentration.csv", header=TRUE)
```

CO2 Emission By Fossil Fuels{data-orientation=columns}
===================================

Column{.sidebar data-width=200}
-----------------------------------
```{r}
distinct_coutries_fuel = countries_by_fuel %>% distinct(Entity) %>% pull()
selectInput("country_choice", label = h4("Select Country"),
            choices = distinct_coutries_fuel, selected = "Afghanistan")
```

row {data-width=350}
---------------------------------
### Fossil Fuel CO2 Emissions{data-height=600}   

```{r, echo=FALSE}

miniContentPanel(
  renderPlot({
    input_df = countries_by_fuel %>% filter(Entity == input$country_choice)
    inputCountry <- paste(input$country_choice)
    ggplot(input_df, aes(x=Year))+
      geom_line(aes(y = CO2.emissions.from.oil, color="Oil"), size=1.5)+
      geom_line(aes(y = CO2.emissions.from.flaring, color="Flaring"), size=1.5)+
      geom_line(aes(y = CO2.emissions.from.cement, color="Cement"), size=1.5)+
      geom_line(aes(y = CO2.emissions.from.coal, color="Coal"), size=1.5)+
      geom_line(aes(y = CO2.emissions.from.gas, color="Gas"), size=1.5)+
      geom_line(aes(y = CO2.emissions.from.other.industry, color="Other Industry"), size=1.5)+
      scale_color_manual(values = c("darkred", "steelblue", "green", "darkorange", "#0036CC", "yellow"))+                          ggtitle(paste(inputCountry), "CO2 Emissions By fossil Fuels, Yearly") +
      labs(x="Year", y="CO2 Emissions from Fossil Fuels\n(metric tonnes per year)")+ 
      theme(axis.title.y = element_text(size=14, family="Trebuchet MS", color="#666666")) +
      theme(plot.title = element_text(size=26, family="Trebuchet MS", face="bold", hjust=0, color="#666666")) +
      theme(axis.text = element_text(size=16, family="Trebuchet MS"))
  }),
  

renderDT({
      input_df = countries_by_fuel %>% filter(Entity == input$country_choice)
      datatable(input_df, extensions = c('Responsive'), 
            options = list(responsive = TRUE))
}),scrollable = TRUE)

```

Per Capital CO2 Emissions {data-orientation=columns}
===================================

Row {data-height=650}
---------------------------------

### Overall Situation Since 
```{r}
```
Row {data-height=350}
---------------------------------

### New situations

```{r}
```

Global CO2 Emissions
====================================

Column{.sidebar data-width=200}
-----------------------------------

```{r}
distinct_coutries_annual_co2 = countries_annual_co2_emission %>% distinct(Entity) %>% pull()
selectInput("annual_country_choice", label = h4("Select Country"),
            choices = distinct_coutries_annual_co2, selected = "Afghanistan")

# observe({
#   annual_input_df = countries_annual_co2_emission %>% filter(Entity == input$annual_country_choice)
#   minValue = min(annual_input_df$Year)
#   maxValue = max(annual_input_df$Year)
#   stepValue = max(annual_input_df$Year) - min(annual_input_df$Year)
  
renderUI ({ 
  annual_input_df = countries_annual_co2_emission %>% filter(Entity == input$annual_country_choice)
    sliderValue = as.vector(annual_input_df$Year)
            sliderInput("yearrange", label = "Year", 
            min = min(as.numeric(annual_input_df$Year)), 
            max = max(as.numeric(annual_input_df$Year)), 
            value = 100,
            animate = TRUE
            )})
```

Column{data-width=400}
-----------------------------------
### Chart A

```{r}
miniContentPanel(
  
  renderPlot({
      annual_input_df = countries_annual_co2_emission %>% filter(Entity == input$annual_country_choice)
      annual_input_df = annual_input_df %>% filter(Year <= input$yearrange)
      ggplot(data = annual_input_df, aes(x = Year, y = Annual.CO2.emissions))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
  }),
  renderDT({
      annual_input_df = countries_annual_co2_emission %>% filter(Entity == input$annual_country_choice)
      annual_input_df = annual_input_df %>% filter(Year <= input$yearrange)
      datatable(annual_input_df, extensions = c('Responsive'), 
            options = list(responsive = TRUE))
}),scrollable = TRUE)

```

Column{data-width=400}
-----------------------------------
### Chart B

```{r}
renderPlot({
      annual_input_df = countries_annual_co2_emission %>% filter(Entity == input$annual_country_choice)
      annual_input_df = annual_input_df %>% filter(Year <= input$yearrange)
      ggplot(data = annual_input_df, aes(x = Year, y = Annual.CO2.emissions))+
          geom_bar(stat="identity", fill="white", color="blue")+
          theme_minimal()
})
```

### Chart C

```{r}
renderPlot({
      country_annual_change_year_wise = countries_year_wise_co2_change %>% filter(Entity == input$annual_country_choice)
      country_annual_change_year_wise = country_annual_change_year_wise = country_annual_change_year_wise %>% filter(Year <= input$yearrange)
      ggplot(data = country_annual_change_year_wise, aes(x = Year, y = Annual.co2.growth.absolute))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})

```


GHG Emission
===================================

Column{.sidebar data-width=200}
-----------------------------------

```{r}
distincy_countries_total_ghg_emissions = total_ghg_emissions %>% distinct(Entity) %>% pull()
selectInput("total_gfg_country_choice", label = h4("Select Country"),
            choices = distincy_countries_total_ghg_emissions, selected = "Afghanistan")
  
renderUI ({ 
  total_ghg_input_df = total_ghg_emissions %>% filter(Entity == input$total_gfg_country_choice)
    sliderValue = as.vector(total_ghg_input_df$Year)
            sliderInput("ghgyearrange", label = "Year", 
            min = min(as.numeric(total_ghg_input_df$Year)), 
            max = max(as.numeric(total_ghg_input_df$Year)), 
            value = 100,
            animate = TRUE
            )})
```


Column{data-width=500}
-----------------------------------

### Country Wise GHG Emission

```{r}
renderPlot({
      country_ghg_change_year_wise = total_ghg_emissions %>% filter(Entity == input$total_gfg_country_choice)
      country_ghg_change_year_wise = country_ghg_change_year_wise = country_ghg_change_year_wise %>% filter(Year <= input$ghgyearrange)
      ggplot(data = country_ghg_change_year_wise, aes(x = Year, y = Total.GHG.emissions.including.LUCF))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```

Column{data-width=300}
-----------------------------------

### Per Capita GHG Emission
```{r}
renderPlot({
      country_percapita_ghg_change_year_wise = percapita_ghg_emissions %>% filter(Entity == input$total_gfg_country_choice)
      country_percapita_ghg_change_year_wise = country_percapita_ghg_change_year_wise = country_percapita_ghg_change_year_wise %>% filter(Year <= input$ghgyearrange)
      ggplot(data = country_percapita_ghg_change_year_wise, aes(x = Year, y = Total.including.LUCF.percapita))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```

### Methane Emission
```{r}
renderPlot({
      methane_change_year_wise = methane_emissions %>% filter(Entity == input$total_gfg_country_choice)
      methane_change_year_wise = methane_change_year_wise = methane_change_year_wise %>% filter(Year <= input$ghgyearrange)
      ggplot(data = methane_change_year_wise, aes(x = Year, y = Total.including.LUCF.CH4.emissions))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```

### Nitrous Oxide Emission

```{r}
renderPlot({
      nitrous_oxide_change_year_wise = nitrous_oxide_emissions %>% filter(Entity == input$total_gfg_country_choice)
      nitrous_oxide_change_year_wise = nitrous_oxide_change_year_wise = nitrous_oxide_change_year_wise %>% filter(Year <= input$ghgyearrange)
      ggplot(data = nitrous_oxide_change_year_wise, aes(x = Year, y =Total.including.LUCF.N2O.emissions))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```

Atmospheric Concentration
===================================

Column{.sidebar data-width=200}
-----------------------------------

```{r}
renderUI ({ 
    sliderValue = as.vector(global_co2_concentration$Year)
            sliderInput("concentrationyearrange", label = "Global CO2 Year Input", 
            min = min(as.numeric(global_co2_concentration$Year)), 
            max = max(as.numeric(global_co2_concentration$Year)), 
            value = 1,
            animate = TRUE
            )
})

renderUI({
      sliderValue = as.vector(global_methane_concentration$Year)
            sliderInput("othergasesyearrange", label = "Global Methane/Nitrous Oxide Year Input", 
            min = min(as.numeric(global_methane_concentration$Year)), 
            max = max(as.numeric(global_methane_concentration$Year)), 
            value = 1750,
            animate = TRUE
            )
})
```


Column{data-width=500}
-----------------------------------

### Global CO2 Concentration

```{r}
renderPlot({
      global_co2_concentration = global_co2_concentration %>% filter(Year <= input$concentrationyearrange)
      ggplot(data = global_co2_concentration, aes(x = Year, y =CO2.concentrations.world))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```

Column{data-width=300}
-----------------------------------

### Methane Concentration
```{r}
renderPlot({
      global_methane_concentration = global_methane_concentration %>% filter(Year <= input$othergasesyearrange)
      ggplot(data = global_methane_concentration, aes(x = Year, y =CH4.concentration.world))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```

### Nitrous Oxide Concentration
```{r}
renderPlot({
      global_nitrous_oxide_concentration = global_nitrous_oxide_concentration %>% filter(Year <= input$othergasesyearrange)
      ggplot(data = global_nitrous_oxide_concentration, aes(x = Year, y =N2O.concentrations.world))+
      geom_line(color = "#0099f9", size = 1) + geom_point(color = "#0099f9", size = 3)
})
```




About US and Data{data-orientation=rows}
====================================

### About Us {data-height=300}

#### Team:
* Abhinav Tripathi 19BCE0548

<br>
<br>

#### About Data: 
  > CO2 Emission Data from Kaggle. 
  
  In this project we are using  CO2 and Greenhouse Emission data, which is downloaded from kaggle and ourworldindata.org.
  This dataset contains 55 columns and 20,000+ rows.
  This dataset contains year wise data of all the countries of the world. This dataset         includes wide range of information regarding CO2 emission (i.e. Growth rate, countries GDP,    CO2 emission per capita, etc.)

```{r}
```

